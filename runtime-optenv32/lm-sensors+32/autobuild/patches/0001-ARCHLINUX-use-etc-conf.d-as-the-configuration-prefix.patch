From 3a97fa37b3c8a80fbe31c4596e4f6940aea214a3 Mon Sep 17 00:00:00 2001
From: Mingcong Bai <jeffbai@aosc.io>
Date: Fri, 27 Dec 2024 14:08:08 +0800
Subject: [PATCH 1/4] ARCHLINUX: use /etc/conf.d as the configuration prefix

---
 prog/detect/sensors-detect   | 14 +++++++-------
 prog/init/lm_sensors.service |  2 +-
 prog/init/sensord.service    |  2 +-
 3 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/prog/detect/sensors-detect b/prog/detect/sensors-detect
index 32fd29f3..ce06a1d6 100755
--- a/prog/detect/sensors-detect
+++ b/prog/detect/sensors-detect
@@ -7386,18 +7386,18 @@ sub write_config
 		}
 	}
 
-	my $have_sysconfig = -d '/etc/sysconfig';
-	printf "Do you want to \%s /etc/sysconfig/lm_sensors? (\%s): ",
-	       (-e '/etc/sysconfig/lm_sensors' ? 'overwrite' : 'generate'),
+	my $have_sysconfig = -d '/etc/conf.d';
+	printf "Do you want to \%s /etc/conf.d/lm_sensors? (\%s): ",
+	       (-e '/etc/conf.d/lm_sensors' ? 'overwrite' : 'generate'),
 	       ($have_sysconfig ? 'YES/no' : 'yes/NO');
 	$_ = read_answer();
 	if (($have_sysconfig and not m/^\s*n/i) or m/^\s*y/i) {
 		unless ($have_sysconfig) {
-			mkdir('/etc/sysconfig', 0777)
-				or die "Sorry, can't create /etc/sysconfig ($!)";
+			mkdir('/etc/conf.d', 0777)
+				or die "Sorry, can't create /etc/conf.d ($!)";
 		}
-		open(local *SYSCONFIG, ">/etc/sysconfig/lm_sensors")
-			or die "Sorry, can't create /etc/sysconfig/lm_sensors ($!)";
+		open(local *SYSCONFIG, ">/etc/conf.d/lm_sensors")
+			or die "Sorry, can't create /etc/conf.d/lm_sensors ($!)";
 		print SYSCONFIG "# Generated by sensors-detect on " . scalar localtime() . "\n";
 		print SYSCONFIG <<'EOT';
 # This file is sourced by /etc/init.d/lm_sensors and defines the modules to
diff --git a/prog/init/lm_sensors.service b/prog/init/lm_sensors.service
index 7d3bf808..7b012b30 100644
--- a/prog/init/lm_sensors.service
+++ b/prog/init/lm_sensors.service
@@ -2,7 +2,7 @@
 Description=Initialize hardware monitoring sensors
 
 [Service]
-EnvironmentFile=/etc/sysconfig/lm_sensors
+EnvironmentFile=/etc/conf.d/lm_sensors
 Type=oneshot
 RemainAfterExit=yes
 ExecStart=-/sbin/modprobe -qab $BUS_MODULES $HWMON_MODULES
diff --git a/prog/init/sensord.service b/prog/init/sensord.service
index 2448beeb..176ee70a 100644
--- a/prog/init/sensord.service
+++ b/prog/init/sensord.service
@@ -3,7 +3,7 @@ Description=Log hardware monitoring data
 After=lm_sensors.service
 
 [Service]
-EnvironmentFile=/etc/sysconfig/sensord
+EnvironmentFile=/etc/conf.d/sensord
 Type=forking
 PIDFile=/var/run/sensord.pid
 ExecStart=/usr/sbin/sensord -i $INTERVAL -l $LOG_INTERVAL -f daemon
-- 
2.47.1

