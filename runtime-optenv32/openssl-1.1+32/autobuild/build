abinfo "Setting up build environment ..."
export CPPFLAGS="${CPPFLAGS} ${CFLAGS}"

abinfo "Configuring openssl-1.1+32 ..."
# Disable tests to speed-up building process for optenv32
"$SRCDIR"/Configure \
    --prefix=/opt/32 \
    --openssldir=/opt/32/etc/ssl \
    --libdir=lib \
    shared zlib enable-ssl2 no-tests \
    -Wa,--noexecstack linux-x86

abinfo "Building openssl-1.1+32 ..."
make

abinfo "Installing openssl-1.1+32 ..."
make install \
    MANDIR=/opt/32/share/man \
    MANSUFFIX=ssl \
    DESTDIR="$PKGDIR"

abinfo "Dropping non-runtime files ..."
rm -rv \
    "$PKGDIR"/opt/32/{bin,etc,include,share} \
    "$PKGDIR"/opt/32/lib/{pkgconfig,lib{crypto,ssl}.so}
